\chapter{Численное и качественное исследование устойчивости  моделей нейронных сетей кольцевой и 
линейной конфигураций с~ограниченным количеством нейронов}
\label{chapter3}

\section{Алгоритм и программа для построения границ областей устойчивости моделей
кольцевых нейронных сетей с ограниченным количеством нейронов}
\label{sec31}


В этом разделе мы опишем алгоритм и программу для построения границ области 
устойчивости моделей кольцевых нейронных сетей с ограниченным количеством нейронов. 
Программа использует фрагменты предыдущих программ <<Анализ устойчивости>>   
(раздел~\ref{sec15})  и <<Устойчивость нейронных сетей>> 
(раздел~\ref{sec21}).

Мы рассматриваем задачу устойчивости модели (см. формулы \eqref{main1}, 
\eqref{main2} соответственно)
\begin{equation}\label{main1chapter4}
    \dot{x}_{j}(t) +  x_{j}(t) +  a\, x_{j-1}(t) + b\, x_{j+1}(t-\tau) = 0 \qquad 
    (j\; {\rm{mod}}\; n),
\end{equation}
\begin{equation}\label{main2chapter4}
    \dot{x}_{j}(t) +  x_{j}(t) +  a\, x_{j-1}(t-\tau)) + b\, x_{j+1}(t-\tau) = 0 \qquad 
    (j\; {\rm{mod}}\; n).
\end{equation}

В дальнейшем  кольцевые сети, описываемые уравнением \eqref{main1chapter4}, 
будем называть сетями с односторонним запаздыванием, а сети, 
описываемые уравнением \eqref{main2chapter4},~--- сетями с двусторонним
запаздыванием.

\subsection{Алгоритм нахождения границы области устойчивости}
\label{subsec311}


Для построения границ областей устойчивости и неустойчивости данных
моделей в плоскости $(a, b)$ применяется отдельный алгоритм. Он предназначен 
для построения замкнутой кривой, состоящей из равномерного массива точек
${R_k}$ и  соответствующей границе области устойчивости круговых нейронных
сетей, с погрешностью $\delta$. 
Априорно предполагается, что границей области устойчивости является замкнутая
кривая, причём область устойчивости находится внутри неё.

Данный алгоритм проиллюстрирован на следующем рис.~\ref{app3_fig:algorithm}.

\begin{figure}[ht]
    \centering
    \includegraphics[width=7cm]{products/app3-algorithm}
    \caption{
        Схема нахождения точек в программе <<Построение  областей
        устойчивости круговых нейронных сетей>>
     }
    \label{app3_fig:algorithm}
\end{figure}

Вначале находим первую точку границы, которая образуется при
пересечении этой границы с осью $0a$. Для этого сначала определяем две точки на
луче $0a$: одну внутри области устойчивости, а другую вне её. В качестве первой
точки подходит точка с координатами $(0,0)$, так как она, очевидно,
соответствует устойчивости уравнения \ref{maineqmatrix}. Вторую точку найдём,
двигаясь по лучу $0a$ с шагом $1$ (инкрементируя параметр $a$ на единицу) до тех
пор, пока точка не окажется вне области устойчивости. Диагностирование
принадлежности точек области устойчивости проводится с помощью
отдельного алгоритма, описанного в следующем пункте. 
Затем методом дихотомии уточняем координаты данной точки до заданной
точности и тем самым получаем точку $R_0$.

Все остальные точки находятся следующим образом: 
\begin{enumerate}
	\item Переходим в полярную систему координат с центром в только что найденной 
  	точке $R_{k}$, так что её ось совпадает с осью $0R_{k}$.
	\item Ищем следующую точку $R_{k+1}$ на расстоянии заданной
        погрешности $\delta$ от точки  $R_{k}$ , проводя итерацию по следующему
    алгоритму.
\end{enumerate}
Определяем начальные параметры:
$$r=\delta,\; \phi_{0}=0, \; \phi_{1}=\pi. $$
Так как точка $R_{k}$ является граничной, то точка $(r, \phi_{0})$ будет лежать
вне области устойчивости, а точка $(r, \phi_1)$ внутри её.   
Следующую точку $R_{k+1}$ найдём половинным делением данной полуокружности 
(а именно угла $\phi_s$), пока не будет достигнута заданная точность. 

Шаг 2 проводим до тех пор, пока кривая не замкнётся. 


\subsection{Алгоритм исследования устойчивости фиксированных точек 
плоскости параметров}
\label{subsec312}

Хотя данная задача уже была решена в программе <<Анализ устойчивости>>
(раздел \ref{sec22}), мы намеренно отказались от данного алгоритма.
Это связано с тем, что алгоритм решает более глобальную задачу 
(нахождения всех значений  $\tau$, обеспечивающих устойчивость исследуемого
уравнения) и является затратным по времени.
Время вычисления принадлежности точек области устойчивости в данном случае
является критичным, так как для получения границы области устойчивости с
заданной точностью требуется исследовать достаточно большое число точек
плоскости $(a,b)$.
Поэтому все исследуемые точки плоскости параметров диагностируются на
устойчивость непосредственно с помощью метода годографов, реализованного с
помощью функции \emph{straightStabAnalizer} (см.~приложение~В).

\begin{enumerate}
  \item 
  Для каждой исследуемой пары значений  $a,b$ вычисляем собственные числа
  $\lambda_{j}^{'}$ и $\mu_{j}^{'} \; (j=1 \ldots n)$ по формулам
  \eqref{lambdamu1} для уравнения \eqref{main1chapter4} и $\lambda_{j}^{''}$ и
  $\mu_{j}^{''} \; (j=1 \ldots n)$ по формулам \eqref{lambdamu2} для уравнения
  \eqref{main2chapter4}. С их помощью находим координаты точек $M_j^{'}$ по
  формулам \eqref{pointsmjmain1} для уравнения \eqref{main1chapter4} и точек 
  $M_{j}^{''}$ по формулам \eqref{pointsmjmain2} для уравнения
  \eqref{main2chapter4}.
  \item 
    Далее требуется определить, находятся ли все $n$ точек  $M_j^{'}$ 
     внутри конуса устойчивости или вне его. Для этого прежде
    всего выполняем простую проверку на непринадлежность конусу: если хотя бы
    для одного $j$ выполнено неравенство $u_{3j}^{'} < -1$, 
то точка $M_{j}^{'}$ находится ниже вершины конуса, что соответствует
неустойчивости уравнения \eqref{main1chapter4} по~Теореме~\ref{th:stab1}. 
Дальнейшее выполнение алгоритма прекращается. 
\item 
Если для всех $j$ выполнено неравенство $u_{3j}^{'} \geqslant -1$, переходим к
проверке принадлежности точек $M_{j}^{'}$ конусу устойчивости.
Это трёхмерная задача, которую мы можем свести к двумерной сечением
  конуса устойчивости плоскостью, параллельной плоскости $(u_1, u_2)$ и
  находящейся на~высоте $u_{3j}^{'}$. Тогда остаётся определить,
  находится ли точка внутри овала устойчивости или нет.
  \item 
  Для этого для каждого $j$ строим овал устойчивости на уровне $u_{3j}^{'}$ и
  находим на нём точку, максимально близкую к точке $M_j^{'}$ при заданной
  точности.
  Если расстояние от данной точки до оси $u_{3}$ меньше расстояния от точки
  $M_j^{'}$ до этой оси, то исследуемая пара значений $a, b$ является 
  неустойчивой для уравнения \eqref{main1chapter4}, и алгоритм завершается.
  \item 
  Если предыдущий шаг покажет, что все точки $M_j^{'}$ лежат внутри овала
  устойчивости, то исследуемая пара значений $a, b$ является устойчивой 
  для уравнения \eqref{main1chapter4}.
\item
Аналогично проходит проверка принадлежности конусу устойчивости точек 
$M_{j}^{''}$ для исследования уравнения \eqref{main2chapter4}.
  \end{enumerate}


\subsection{Функциональное назначение и область применения программы}
\label{subsec313}


Программа <<Построение  областей устойчивости круговых нейронных сетей>> 
строит области устойчивости для круговых нейронных сетей  \eqref{main1chapter4},
\eqref{main2chapter4} с заданным количеством нейронов в плоскости параметров $a$
и $b$ в сравнении с областью устойчивости таких же нейронных сетей, но с
бесконечным числом нейронов, и сохраняет результаты в графических файлах 
определённого пользователем формата. 
Программа выполнена в высокоуровневой среде для математических вычислений 
MATLAB 7.11.0 (R2010b)  посредством matlab APY для создания графического интерфейса 
пользователя (GUI). Исходный код программы представлен в приложении В.

Программа зарегистрирована в Объединенном фонде электронных ресурсов 
<<Наука и образование>> (ОФЭРНиО), информация о ней представлена в \cite{product3_ofernio}, 
а пользовательская версия программы доступна по электронному адресу \cite{program3}. 

\subsection{Использование}
\label{subsec314}

На~рис.~\ref{app3_fig:main_window1} представлено главное окно программы, в
котором задаются входные данные.
\begin{figure}[ht]
    \centering
    \includegraphics[scale=0.52]{products/app3-main1}
    \caption{
        Главное окно программы <<Построение  областей устойчивости круговых 
        нейронных сетей>> при~выборе первой конфигурации
     }
    \label{app3_fig:main_window1}
\end{figure}

Прежде всего пользователю предлагается выбрать конфигурацию нейронной сети. 
В программе доступны два варианта кругового соединения нейронов: с малым 
запаздыванием взаимодействия с правыми соседями (уравнение \eqref{main1chapter4}) 
и с одинаковым запаздыванием взаимодействия с правыми и левыми соседями 
(уравнение \eqref{main2chapter4}). Выбирая первую или вторую радиокнопку, 
пользователь определяет, для какой именно модели будет проводиться анализ 
устойчивости. На рис.~\ref{app3_fig:main_window1} выбрана первая конфигурация, 
а на рис.~\ref{app3_fig:main_window2}~---  вторая. 
Ниже, на панели ввода представлено название, описание и рисунок выбранной конфигурации. 
Пользователю необходимо ввести параметр $\tau$, для которого будут строиться
области устойчивости, определить количество нейронов в сети (причём графики
будут построены для всех $n$, определённых пользователем), 
задать директорию для сохранения, выбрать расширение, 
с~которым будут сохраняться графики, и определить погрешность построения.

\begin{figure}[ht]
    \centering
    \includegraphics[scale=0.52]{products/app3-main2}
    \caption{
        Главное окно программы <<Построение  областей устойчивости круговых 
        нейронных сетей>> при~выборе второй  конфигурации 
        }
    \label{app3_fig:main_window2}
\end{figure}

После ввода данных в обоих случаях для  начала расчета необходимо нажать 
на кнопку <<Рассчитать...>>. В процессе построения будут появляться вспомогательные окна, 
представляющие результаты расчетов. Все графики сохраняются в выбранную 
пользователем директорию в заданном формате и именуются определённым образом: 
<<type\_tau\_n.ext>>, \\
где
type –- тип соединения нейронов: <<asym>> для первого соединения и  <<sym>> для второго;\\
tau –- величина запаздывания;\\
n --– количество нейронов;\\
ext --– расширение файла.\\
Программа также строит область устойчивости для бесконечного числа нейронов. 

После проведения расчетов пользователь может изменить входные параметры и 
ещё раз выполнить построение областей устойчивости. Графики будут сохранятся 
во вновь назначенную пользователем директорию или в ту же, если он не поменял её. 
Во втором случае она будут дополняться к уже существующим, а если найдутся графики 
с одинаковыми параметрами, то файлы будут перезаписаны. 

При вводе некорректных данных программа выдает различные сообщения об ошибках. 
Также программа анализирует потенциальную возможность затратить большое 
количество времени на вычисления, когда пользователь назначает слишком высокую точность, 
либо большое количество графиков. В этом случае программа просит пользователя 
подтвердить, что он действительно хочет выполнить расчёты при заданных параметрах. 
Пример такого сообщения приведён на рис.~\ref{app3_fig:warning}.
\begin{figure}[ht]
    \centering
    \includegraphics[scale=0.7]{products/app3-warning}
    \caption{
        Требование подтверждения необходимости выполнения длительных расчетов 
        }
    \label{app3_fig:warning}
\end{figure}

Применение программы <<Построение  областей устойчивости круговых
нейронных сетей>> позволило в плоскости параметров построить границы областей 
устойчивости для систем \eqref{main1chapter4}, \eqref{main2chapter4} с
ограниченным количеством нейронов. Полученные области устойчивости и
неустойчивости исследуемых моделей для различных значений запаздывания и
различного числа нейронов  будут представлены в следующих разделах данной главы.
Отметим, что исходный код описанной программы с небольшими изменениями может 
применяться для получения областей устойчивости не только кольцевых нейронных
сетей, но и других систем, описываемых уравнением~\eqref{maineqmatrix} с совместно
триангулируемыми матрицами. В частности, он применялся автором для построения 
областей устойчивости полносвязных и звездных структур нейронных сетей
(см.~\cite{Khokhlova_2012}), а также двухслойного соединения нейронов
(см.~\cite{conf_Kursk_2012}).









 
